<ng-include src="'./views/partials/nav.html'"></ng-include>
<div id="main" class="container-fluid">
	<div class="col-xs-12 col-sm-3 col-md-3 col-lg-2 filterbar">
			<ng-include src="'./views/partials/logo.html'"></ng-include>
			<div class="reportcategories">
				<h2 class="hidden-xs text-center"><translate>Report categories</translate>
					<span ng-controller="HelpController as help">
						<span class="glyphicon glyphicon-question-sign help" ng-click="help.open('report');"></span>
						<ng-include src="'./views/partials/help_report.html'"></ng-include>
					</span>								
				</h2>
				<h2 class="hidden-sm hidden-md hidden-lg text-center" style="margin-top:5px"><translate>Report</translate>
					<span ng-controller="HelpController as help">
						<span class="glyphicon glyphicon-question-sign help" ng-click="help.open('report');"></span>
						<ng-include src="'./views/partials/help_report.html'"></ng-include>
					</span>							
				</h2>				
				<div class="text-center" ng-show="vm.player == null" translate>Please select a player</div>
				<div class="hidden-xs" ng-hide="vm.player == null">
					<button class="button col-sm-12" ng-hide="vm.atOverview" ng-click="vm.changeReportType('overview')">{{vm.overview.name}}</button>
					<button class="button col-sm-12" ng-repeat="reportoption in vm.reportoptions" ng-click="vm.changeReportType(reportoption)">{{reportoption.name}}</button>
				</div>			
			</div>
		</div>
	<div>
		<span class="spinner" us-spinner="{radius:30, width:8, length: 16}" spinner-key="spinner-1"></span>
	</div>
	<div class="col-xs-12 col-sm-9 col-md-9 col-lg-10">
		<div class="row">
			<div class="hidden-sm hidden-md hidden-lg" ng-show="main.player">
				<button class="button col-xs-12" ng-click="vm.selectYourself()" translate>Select yourself</button>
			</div>
			<div class="hidden-sm hidden-md hidden-lg text-center" translate>or</div>
			<div class="playersearch-container form-inline">
				<div class="col-xs-12 col-sm-6 col-md-6 col-lg-4 input-group playersearch form-group">
					<input id="playerselect" class="playerselect form-control" ng-model="vm.playerselect" typeahead="person for person in vm.getPeople($viewValue)" typeahead-min-length="1" 
						typeahead-template-url="playersearchTemplate.html" typeahead-input-formatter="vm.formatPlayersearch($model)" placeholder="{{'Select by username or pfsnumber'|translate}}"
						typeahead-on-select="vm.selectPlayer()">			
					<i class="glyphicon glyphicon-search form-control-feedback" style="color: grey;"></i>				
				</div>
				<div class="form-group hidden-xs"  ng-show="main.player">
					or <button class="button" ng-click="vm.selectYourself()" translate>Select yourself</button>
				</div>
			</div>
			<div class="hidden-sm hidden-md hidden-lg" ng-hide="vm.player == null">
				<hr style="border: 1px solid black;">			
				<span class="hidden-xs text-center" translate>Select category</span>
				<h4 class="hidden-sm hidden-md hidden-lg text-center" translate>Select category</h4>
				<select class="form-control" ng-model="vm.reporttype" ng-options="reportoption.name for reportoption in vm.reportoptions" ng-change="vm.getContent()"></select>
				<button class="button col-xs-12" ng-hide="vm.atOverview" ng-click="vm.changeReportType('overview')" style="margin-top: 5px;">{{vm.overview.name}}</button>				
			</div>				
		</div>	
		
		<div class="row" ng-hide="vm.player == null">
			<div ng-show="vm.player.public == 0 && vm.player.pfsnumber != main.player.pfsnumber" class="reportingfor"><translate>Checking out</translate> {{vm.player.name}} ({{vm.player.pfsnumber}})</div>
			<div ng-show="vm.player.public == 0 && vm.player.pfsnumber != main.player.pfsnumber"><translate>You cannot report for</translate> <strong>{{vm.player.name}}</strong> <translate>because he/she has not allowed public reporting in his/her profile.</translate></div>
			<div ng-show="vm.player.public == 1 || vm.player.pfsnumber == main.player.pfsnumber" class="hidden-xs reportingfor"><translate>Reporting for</translate> {{vm.player.name}} ({{vm.player.pfsnumber}})</div>
			<div ng-show="vm.player.public == 1 || vm.player.pfsnumber == main.player.pfsnumber" class="hidden-sm hidden-md hidden-lg reportingfor text-center"><translate>Reporting for</translate> {{vm.player.name}} ({{vm.player.pfsnumber}})</div>
			<div ng-show="vm.player.public == 1 && vm.player.pfsnumber != main.player.pfsnumber"><translate>You can report for</translate> <strong>{{vm.player.name}}</strong> <translate>because he/she has chosen to allow public reporting in his/her profile.</translate></div>
			<div ng-show="vm.player.pfsnumber == main.player.pfsnumber"><translate>You are now reporting for yourself.</translate></div>
		</div>
		
		<div class="row" ng-hide="vm.player == null">
			<hr class="hidden-sm hidden-md hidden-lg" style="border: 1px solid black;">		
			<h4 class="capitalize hidden-xs" ng-show="vm.atOverview" translate>Overview</h4>
			<h4 class="capitalize hidden-sm hidden-md hidden-lg text-center" ng-show="vm.atOverview" translate>Overview</h4>
			<h4 class="capitalize" ng-hide="vm.atOverview">{{vm.reporttype.name}}</h4>
		</div>
		<div class="row" ng-hide="vm.player == null">
			<div class="col-sm-10" ng-hide="vm.atOverview">
				<div class="row vertical-container">
					<span class="vertical pfs" translate>PFS PC</span>&nbsp;&nbsp;&nbsp;
					<span class="vertical core" translate>CORE PC</span>&nbsp;&nbsp;&nbsp;
					<span class="vertical pfsgm" translate>PFS GM</span>&nbsp;&nbsp;
					<span class="vertical coregm" translate>CORE GM</span>
				</div>
				<div ng-repeat="content in vm.content track by $index" class="reportoption" ng-class="{'disabled-checkbox': vm.player.public == 0}">
					<input id="pfs{{content.id}}" ng-model="content.state.pfs" type="checkbox" ng-click="vm.saveScenario(content.id, 'pfs', $index)" ng-disabled="vm.player.public == 0"><label class="report-title disabled-checkbox" for="pfs{{content.id}}"></label>&nbsp;&nbsp;
					<input id="core{{content.id}}" ng-model="content.state.core" type="checkbox" ng-click="vm.saveScenario(content.id, 'core', $index)" ng-disabled="vm.player.public == 0"><label class="report-title" for="core{{content.id}}"></label>&nbsp;&nbsp;
					<input id="pfs_gm{{content.id}}" ng-model="content.state.pfs_gm" type="checkbox" ng-click="vm.saveScenario(content.id, 'pfs_gm', $index)" ng-disabled="vm.player.public == 0"><label class="report-title" for="pfs_gm{{content.id}}"></label>&nbsp;&nbsp;
					<input id="core_gm{{content.id}}" ng-model="content.state.core_gm" type="checkbox" ng-click="vm.saveScenario(content.id, 'core_gm', $index)" ng-disabled="vm.player.public == 0"><label class="report-title" for="core_gm{{content.id}}"></label>&nbsp;&nbsp;
					<span class="hidden-sm hidden-md hidden-lg report-title-xs">
						<span ng-hide="!content.season || content.season == '99'">
							#{{content.season}}-{{content.number}}
						</span> 
						{{content.name}}
					</span>
					<span class="hidden-xs report-title">
						<span ng-hide="!content.season || content.season == '99'">
							#{{content.season}}-{{content.number}}</span> {{content.name}}
						</span>
						<span ng-show="content.archived"> 
							<strong translate>(Retired)</strong>
						</span>			
				</div>
			</div>
			<div ng-show="vm.atOverview && vm.player != null">
				<p translate>Select a playtype to show player progress</p>
				<div class="playedprogress hidden-xs">
					<button class="button" ng-click="vm.getPlayerprogress('pfs')" translate>PFS PC</button>
					<button class="button" ng-click="vm.getPlayerprogress('core')" translate>CORE PC</button>
					<button class="button" ng-click="vm.getPlayerprogress('pfs_gm')" translate>PFS GM</button>
					<button class="button" ng-click="vm.getPlayerprogress('core_gm')" translate>CORE GM</button>
					<h4><translate>Player progress for:</translate> {{vm.progresstype.name | uppercase}}</h4>
				</div>
				<div class="hidden-sm hidden-md hidden-lg">
					<button class="button col-xs-12" ng-click="vm.getPlayerprogress('pfs')" style="margin-bottom: 5px" translate>PFS PC</button>
					<button class="button col-xs-12" ng-click="vm.getPlayerprogress('core')" style="margin-bottom: 5px" translate>CORE PC</button>
					<button class="button col-xs-12" ng-click="vm.getPlayerprogress('pfs_gm')" style="margin-bottom: 5px" translate>PFS GM</button>
					<button class="button col-xs-12" ng-click="vm.getPlayerprogress('core_gm')" style="margin-bottom: 5px" translate>CORE GM</button>
					<h4 class="text-center"><translate>Player progress for:</translate> {{vm.progresstype.name | uppercase}}</h4>
				</div>			
				<div class="hidden-xs">
					<div class="row playedprogress" ng-repeat="playerprogress in vm.playerprogress">
						<div class="col-xs-12 col-sm-12 col-md-8 col-lg-6">
							<span  ng-hide="playerprogress.season == 'Modules' || playerprogress.season == 'APs'" class="progress-label"><translate>Season</translate> {{playerprogress.season}}</span>
							<span  ng-show="playerprogress.season == 'Modules' || playerprogress.season == 'APs'" class="progress-label">{{playerprogress.season}}</span>
							<div class="progress" style="width: 100%">
								<div class="progress-bar progress-bar-danger" role="progressbar" aria-valuenow="40" aria-valuemin="0" aria-valuemax="100" style="width: {{(playerprogress.completed / playerprogress.total) * 100}}%; min-width: 5%;">
						    		{{playerprogress.completed}}/{{playerprogress.total}}
						  		</div>
					  		</div>
					  	</div>
					</div>
					<div>
						<strong><translate>Grand total:</translate> {{vm.totalplayed}} / {{vm.totalavailable}}</strong>
					</div>
				</div>
				<div class="hidden-sm hidden-md hidden-lg">
					<div class="col-xs-12" ng-repeat="playerprogress in vm.playerprogress">
						<span ng-hide="playerprogress.season == 'Modules' || playerprogress.season == 'APs'" class="col-xs-12 progress-xs">
							&nbsp;
							<span class="progress-xs-label"><translate>Season</translate> {{playerprogress.season}} ({{playerprogress.completed}}/{{playerprogress.total}})</span>
							<span class="progress-xs-bar" style="width: {{(playerprogress.completed / playerprogress.total) * 100}}%; min-width: 5%;"></span>
						</span>
						<span ng-show="playerprogress.season == 'Modules' || playerprogress.season == 'APs'" class="col-xs-12 progress-xs"><span class="progress-xs-bar" style="width: {{(playerprogress.completed / playerprogress.total) * 100}}%; min-width: 5%;"></span>{{playerprogress.season}} ({{playerprogress.completed}}/{{playerprogress.total}})</span>
					</div>
					<div class="col-xs-12 text-center">
						<h4><translate>Grand total:</translate> {{vm.totalplayed}} / {{vm.totalavailable}}</h4>
					</div>
				</div>
			</div>
		</div>
	</div>		
</div>